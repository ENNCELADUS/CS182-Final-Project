=== GPU DIAGNOSTICS ===
Thu Jun  5 17:19:04 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.54.15              Driver Version: 550.54.15      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     On  |   00000000:82:00.0 Off |                  N/A |
| 28%   30C    P8             36W /  250W |       0MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

=== CUDA VISIBLE DEVICES ===
CUDA_VISIBLE_DEVICES: 0

=== PYTORCH GPU CHECK ===
CUDA available: True
CUDA version: 12.4
GPU count: 1
GPU 0: NVIDIA GeForce RTX 2080 Ti
  - Memory test: OK

=== STARTING TRAINING ===
ðŸ§¬ COMPREHENSIVE V4.1 MODEL COMPARISON
============================================================
Using device: cuda

ðŸ“Š Loading data...
Script directory: /public/home/wangar2023/CS182-Final-Project/src/mask_autoencoder
Project root: /public/home/wangar2023/CS182-Final-Project
Loading data...
Looking for data in: /public/home/wangar2023/CS182-Final-Project/data/full_dataset
âœ… Found: train_data.pkl
âœ… Found: validation_data.pkl
âœ… Found: test1_data.pkl
âœ… Found: test2_data.pkl
âœ… Found: embeddings_standardized.pkl

Examining training data structure:
DataFrame columns: ['uniprotID_A', 'uniprotID_B', 'isInteraction', 'trainTest', 'sequence_A', 'sequence_B']
First row sample: {'uniprotID_A': 'O43759', 'uniprotID_B': 'P59991', 'isInteraction': 0, 'trainTest': 'train', 'sequence_A': 'MEGGAYGAGKAGGAFDPYTLVRQPHTILRVVSWLFSIVVFGSIVNEGYLNSASEGEEFCIYNRNPNACSYGVAVGVLAFLTCLLYLALDVYFPQISSVKDRKKAVLSDIGVSAFWAFLWFVGFCYLANQWQVSKPKDNPLNEGTDAARAAIAFSFFSIFTWAGQAVLAFQRYQIGADSALFSQDYMDPSQDSSMPYAPYVEPTGPDPAGMGGTYQQPANTFDTEPQGYQSQGY', 'sequence_B': 'MCHTSCSSGCQPACCAPSPCQPACCVPSSCQASCCVPVGCQSSVCVPVSFKPAVCLPVSCQSSVCVPMSFKSAVCVPVSCQSSVCVPVSCRPIVCAAPSCQSSLCVPVSCRPVVYAAPSCQSSGCCQPSCTSVLCRPISYSISSCC'}

Loading protein embeddings...
Loaded 12026 protein embeddings
       uniprotID_A  ...                                         sequence_B
100353      O43759  ...  MCHTSCSSGCQPACCAPSPCQPACCVPSSCQASCCVPVGCQSSVCV...
118225      P54646  ...  MESPGESGAGSPGAPSPSSFTTGHLAREKPAQDPLYDVPNASGGQA...
89464       O15344  ...  MAAADAEAVPARGEPQQDCCVKTELLGEETPMAADEGSAEKQAGEA...
90759       O14964  ...  MESENMDSENMKTENMESQNVDFESVSSVTALEALSKLLNPEEEDD...
126347      Q5VYS8  ...  MVGREKELSIHFVPGSCRLVEEEVNIPNRRVLVTGATGLLGRAVHK...

[5 rows x 6 columns]
Protein ID: Q00994, Embedding shape: (113, 960)
Protein ID: Q8TC90, Embedding shape: (408, 960)
Protein ID: Q9UJY1, Embedding shape: (198, 960)
Protein ID: Q9Y6Q6, Embedding shape: (618, 960)
Protein ID: A4QMS7, Embedding shape: (149, 960)
Using columns: Protein A = 'uniprotID_A', Protein B = 'uniprotID_B', Interaction = 'isInteraction'
Dataset: 85329 valid pairs out of 85329 total pairs
Using columns: Protein A = 'uniprotID_A', Protein B = 'uniprotID_B', Interaction = 'isInteraction'
Dataset: 21333 valid pairs out of 21333 total pairs
Using columns: Protein A = 'uniprotID_A', Protein B = 'uniprotID_B', Interaction = 'isInteraction'
Dataset: 24898 valid pairs out of 24898 total pairs
Using columns: Protein A = 'uniprotID_A', Protein B = 'uniprotID_B', Interaction = 'isInteraction'
Dataset: 136939 valid pairs out of 136939 total pairs
Train samples: 85329
Validation samples: 21333
Test1 samples: 24898
Test2 samples: 136939

============================================================
ðŸš€ TRAINING: Simplified_v4.1_256
============================================================

ðŸ”§ Training: Simplified_v4.1_256
   Parameters: 411,649
   Learning Rate: 0.005
   Expected epochs: 25
   Embed dim: 256
   Epoch  1: Train Loss=0.6982, Val Loss=0.6656, Val AUC=0.6365, Val Acc=0.5882
   Epoch  2: Train Loss=0.6515, Val Loss=0.6255, Val AUC=0.6933, Val Acc=0.6380
   Epoch  3: Train Loss=0.6347, Val Loss=0.6283, Val AUC=0.7113, Val Acc=0.6395
   Epoch  4: Train Loss=0.6251, Val Loss=0.6171, Val AUC=0.7170, Val Acc=0.6373
   Epoch  5: Train Loss=0.6173, Val Loss=0.6053, Val AUC=0.7271, Val Acc=0.6580
   Epoch 10: Train Loss=0.5920, Val Loss=0.5789, Val AUC=0.7540, Val Acc=0.6803
   Epoch 20: Train Loss=0.5385, Val Loss=0.5503, Val AUC=0.7839, Val Acc=0.7030
   ðŸ’¾ Saved final model: simplified_v4.1_256_final_20250605_222839.pth

ðŸ“ˆ Evaluating Simplified_v4.1_256 on test sets...
   Test1 - AUROC: 0.7322, AUPRC: 0.7333, Acc: 0.6576, F1: 0.6937
   Test2 - AUROC: 0.7284, AUPRC: 0.2631, Acc: 0.5661, F1: 0.2439
   ðŸ’¾ Saved predictions to: results/v4_1_comparison/Simplified_v4.1_256_test1_predictions.json
   ðŸ’¾ Saved predictions to: results/v4_1_comparison/Simplified_v4.1_256_test2_predictions.json
   ðŸ“Š Saved evaluation plots: results/v4_1_comparison/Simplified_v4.1_256_evaluation_plots.png
âœ… Simplified_v4.1_256 completed successfully!

============================================================
ðŸš€ TRAINING: Enhanced_v4.1_256_2layers
============================================================

ðŸ”§ Training: Enhanced_v4.1_256_2layers
   Parameters: 1,532,161
   Learning Rate: 0.003
   Expected epochs: 30
   Embed dim: 256
