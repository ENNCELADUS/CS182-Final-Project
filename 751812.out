=== GPU DIAGNOSTICS ===
Mon Jun  2 20:22:01 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.54.15              Driver Version: 550.54.15      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     On  |   00000000:18:00.0 Off |                  N/A |
| 28%   29C    P8             21W /  250W |       0MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA GeForce RTX 2080 Ti     On  |   00000000:5E:00.0 Off |                  N/A |
| 27%   30C    P8             22W /  250W |       0MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA GeForce RTX 2080 Ti     On  |   00000000:AF:00.0 Off |                  N/A |
| 27%   29C    P8             15W /  250W |       0MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA GeForce RTX 2080 Ti     On  |   00000000:D8:00.0 Off |                  N/A |
| 28%   29C    P8             31W /  250W |       0MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

=== CUDA VISIBLE DEVICES ===
CUDA_VISIBLE_DEVICES: 0,1,2,3

=== PYTORCH GPU CHECK ===
CUDA available: True
CUDA version: 12.4
GPU count: 4
GPU 0: NVIDIA GeForce RTX 2080 Ti
  - Memory test: OK
GPU 1: NVIDIA GeForce RTX 2080 Ti
  - Memory test: OK
GPU 2: NVIDIA GeForce RTX 2080 Ti
  - Memory test: OK
GPU 3: NVIDIA GeForce RTX 2080 Ti
  - Memory test: OK

=== STARTING TRAINING ===
üî• SCRIPT STARTED - Python v4.py is running!
Enhanced Protein-Protein Interaction Prediction v4
============================================================
Features: RoPE encoding, 16-layer transformers, cross-attention, enhanced MLP
============================================================
üî• ABOUT TO LOAD DATA...
üî• Inside load_data function
üî• Current directory: /public/home/wangar2023/CS182-Final-Project/src/mask_autoencoder
Script directory: /public/home/wangar2023/CS182-Final-Project/src/mask_autoencoder
Project root: /public/home/wangar2023/CS182-Final-Project
Loading data...
Looking for data in: /public/home/wangar2023/CS182-Final-Project/data/full_dataset
üî• Checking file existence...
‚úÖ Found: train_data.pkl
‚úÖ Found: validation_data.pkl
‚úÖ Found: test1_data.pkl
‚úÖ Found: test2_data.pkl
‚úÖ Found: embeddings_standardized.pkl
üî• Loading pickle files...
üî• Loading train_data.pkl...
üî• Loading validation_data.pkl...
üî• Loading test1_data.pkl...
üî• Loading test2_data.pkl...

Examining training data structure:
DataFrame columns: ['uniprotID_A', 'uniprotID_B', 'isInteraction', 'trainTest', 'sequence_A', 'sequence_B']
First row sample: {'uniprotID_A': 'O43759', 'uniprotID_B': 'P59991', 'isInteraction': 0, 'trainTest': 'train', 'sequence_A': 'MEGGAYGAGKAGGAFDPYTLVRQPHTILRVVSWLFSIVVFGSIVNEGYLNSASEGEEFCIYNRNPNACSYGVAVGVLAFLTCLLYLALDVYFPQISSVKDRKKAVLSDIGVSAFWAFLWFVGFCYLANQWQVSKPKDNPLNEGTDAARAAIAFSFFSIFTWAGQAVLAFQRYQIGADSALFSQDYMDPSQDSSMPYAPYVEPTGPDPAGMGGTYQQPANTFDTEPQGYQSQGY', 'sequence_B': 'MCHTSCSSGCQPACCAPSPCQPACCVPSSCQASCCVPVGCQSSVCVPVSFKPAVCLPVSCQSSVCVPMSFKSAVCVPVSCQSSVCVPVSCRPIVCAAPSCQSSLCVPVSCRPVVYAAPSCQSSGCCQPSCTSVLCRPISYSISSCC'}

Loading protein embeddings...
üî• Loading embeddings_standardized.pkl (this might take a while)...
üî• Embeddings loaded! Count: 12026
üî• ABOUT TO PRINT TRAIN_DATA.HEAD()...
Training data shape: (85329, 6)
Sample row keys: ['uniprotID_A', 'uniprotID_B', 'isInteraction', 'trainTest', 'sequence_A', 'sequence_B']
First protein A: O43759
First protein B: P59991
First interaction: 0
üî• ABOUT TO LOOP THROUGH PROTEIN EMBEDDINGS...
Protein ID: Q00994, Embedding shape: (113, 960)
Protein ID: Q8TC90, Embedding shape: (408, 960)
Protein ID: Q9UJY1, Embedding shape: (198, 960)
Protein ID: Q9Y6Q6, Embedding shape: (618, 960)
Protein ID: A4QMS7, Embedding shape: (149, 960)
üî• RETURNING FROM LOAD_DATA FUNCTION...
üî• DATA LOADING COMPLETED SUCCESSFULLY!

Data loaded successfully:
Training data: 85329 pairs
Validation data: 21333 pairs
Test1 data: 24898 pairs
Test2 data: 136939 pairs
Protein embeddings: 12026 proteins
üî• ABOUT TO CHECK FOR CHECKPOINTS...
üîç Checkpoint detection disabled - starting fresh training...
üî• STARTING TRAINING CONFIGURATIONS...
üî• CONFIGURATIONS DEFINED: 2 configs
üî• ENTERING TRAINING LOOP...
üî• STARTING CONFIG: variable_length

============================================================
Training enhanced model with variable_length embeddings...
============================================================
üî• CALLING train_model() for variable_length...
üî• INSIDE train_model() - START
üî• Parameters: epochs=3, batch_size=2, variable_length=True
üî• Creating ProteinPairDataset for training...
Using columns: Protein A = 'uniprotID_A', Protein B = 'uniprotID_B', Interaction = 'isInteraction'
üî• Dataset filtering: Processing 85329 pairs...
Dataset: 85329 valid pairs out of 85329 total pairs
üî• Creating ProteinPairDataset for validation...
Using columns: Protein A = 'uniprotID_A', Protein B = 'uniprotID_B', Interaction = 'isInteraction'
üî• Dataset filtering: Processing 21333 pairs...
Dataset: 21333 valid pairs out of 21333 total pairs
üî• Creating DataLoader for training dataset (85329 samples)...
üî• Creating DataLoader for validation dataset (21333 samples)...
üî• DataLoaders created successfully!
üî• Calculating training statistics...
üìä TRAINING STATISTICS:
Training samples: 85,329
Validation samples: 21,333
Batch size: 2
Training batches per epoch: 42665
Validation batches per epoch: 10667
Total epochs: 3
Total training steps: 127,995
Progress reports every 50 batches
Checkpoints saved every 1 epochs
üî• Starting GPU detection...
üî• CUDA available, clearing cache...

üîç GPU HEALTH CHECK:
Available GPUs: 4
üî• Testing GPU 0...
  GPU 0: NVIDIA GeForce RTX 2080 Ti (10.7GB) - ‚úÖ Working
üî• Testing GPU 1...
  GPU 1: NVIDIA GeForce RTX 2080 Ti (10.7GB) - ‚úÖ Working
üî• Testing GPU 2...
  GPU 2: NVIDIA GeForce RTX 2080 Ti (10.7GB) - ‚úÖ Working
üî• Testing GPU 3...
  GPU 3: NVIDIA GeForce RTX 2080 Ti (10.7GB) - ‚úÖ Working
Working GPUs: [0, 1, 2, 3]
Will use DataParallel with 4 GPUs
GPU Memory before training: 0.00 GB
üî• Creating enhanced model...
üî• Model created and moved to cuda!
üî• Setting up DataParallel with GPUs: [0, 1, 2, 3]
üî• DataParallel setup successful!
Batch size per GPU: 1
Effective total batch size: 4
‚ö†Ô∏è Batch size adjusted from 2 to 4
üî• Creating optimizer and scheduler...
üî• Setting up training variables...
üî• Creating directories...
Training enhanced model with variable_length=True
Model parameters: 20,226,433
Best model will be saved to: models/ppi_v4_enhanced_best_20250602-202237.pth
Checkpoints will be saved to: models/checkpoints_20250602-202237/
üî• Testing model with first batch before training...
üî• Test batch: 2 samples, emb_a: torch.Size([2, 740, 960]), emb_b: torch.Size([2, 802, 960])
üî• Model test SUCCESSFUL! Output: torch.Size([2, 1])
üî• ENTERING TRAINING LOOP...
