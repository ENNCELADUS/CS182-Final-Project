=== GPU DIAGNOSTICS ===
Fri Jun  6 01:42:35 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.54.15              Driver Version: 550.54.15      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     On  |   00000000:82:00.0 Off |                  N/A |
| 30%   33C    P8             37W /  250W |       0MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

=== CUDA VISIBLE DEVICES ===
CUDA_VISIBLE_DEVICES: 0

=== PYTORCH GPU CHECK ===
CUDA available: True
CUDA version: 12.4
GPU count: 1
GPU 0: NVIDIA GeForce RTX 2080 Ti
  - Memory test: OK

=== STARTING TRAINING ===
Configuration:
  batch_size: 8
  learning_rate: 0.0001
  num_epochs: 50
  weight_decay: 0.01
  use_scheduler: True
  early_stopping: True
  patience: 10
  num_workers: 0
  mae_checkpoint_path: None
  freeze_encoder: True
  use_lora: False
  save_dir: models/v5_training_20250606_014243
  log_dir: logs/v5_training_20250606_014243
ðŸ§¬ V5 PPI CLASSIFIER TRAINING
==================================================
Using device: cuda
CUDA device name: NVIDIA GeForce RTX 2080 Ti
CUDA memory allocated: 0.00 GB
CUDA memory cached: 0.00 GB

ðŸ“Š Loading data...
Script directory: /public/home/wangar2023/CS182-Final-Project/src/mask_autoencoder
Project root: /public/home/wangar2023/CS182-Final-Project
Loading data...
Looking for data in: /public/home/wangar2023/CS182-Final-Project/data/full_dataset
âœ… Found: train_data.pkl
âœ… Found: validation_data.pkl
âœ… Found: test1_data.pkl
âœ… Found: test2_data.pkl
âœ… Found: embeddings_standardized.pkl

Examining training data structure:
DataFrame columns: ['uniprotID_A', 'uniprotID_B', 'isInteraction', 'trainTest', 'sequence_A', 'sequence_B']
First row sample: {'uniprotID_A': 'O43759', 'uniprotID_B': 'P59991', 'isInteraction': 0, 'trainTest': 'train', 'sequence_A': 'MEGGAYGAGKAGGAFDPYTLVRQPHTILRVVSWLFSIVVFGSIVNEGYLNSASEGEEFCIYNRNPNACSYGVAVGVLAFLTCLLYLALDVYFPQISSVKDRKKAVLSDIGVSAFWAFLWFVGFCYLANQWQVSKPKDNPLNEGTDAARAAIAFSFFSIFTWAGQAVLAFQRYQIGADSALFSQDYMDPSQDSSMPYAPYVEPTGPDPAGMGGTYQQPANTFDTEPQGYQSQGY', 'sequence_B': 'MCHTSCSSGCQPACCAPSPCQPACCVPSSCQASCCVPVGCQSSVCVPVSFKPAVCLPVSCQSSVCVPMSFKSAVCVPVSCQSSVCVPVSCRPIVCAAPSCQSSLCVPVSCRPVVYAAPSCQSSGCCQPSCTSVLCRPISYSISSCC'}

Loading protein embeddings...
Loaded 12026 protein embeddings
       uniprotID_A  ...                                         sequence_B
100353      O43759  ...  MCHTSCSSGCQPACCAPSPCQPACCVPSSCQASCCVPVGCQSSVCV...
118225      P54646  ...  MESPGESGAGSPGAPSPSSFTTGHLAREKPAQDPLYDVPNASGGQA...
89464       O15344  ...  MAAADAEAVPARGEPQQDCCVKTELLGEETPMAADEGSAEKQAGEA...
90759       O14964  ...  MESENMDSENMKTENMESQNVDFESVSSVTALEALSKLLNPEEEDD...
126347      Q5VYS8  ...  MVGREKELSIHFVPGSCRLVEEEVNIPNRRVLVTGATGLLGRAVHK...

[5 rows x 6 columns]
Protein ID: Q00994, Embedding shape: (113, 960)
Protein ID: Q8TC90, Embedding shape: (408, 960)
Protein ID: Q9UJY1, Embedding shape: (198, 960)
Protein ID: Q9Y6Q6, Embedding shape: (618, 960)
Protein ID: A4QMS7, Embedding shape: (149, 960)
Using columns: Protein A = 'uniprotID_A', Protein B = 'uniprotID_B', Interaction = 'isInteraction'
Dataset: 85329 valid pairs out of 85329 total pairs
Using columns: Protein A = 'uniprotID_A', Protein B = 'uniprotID_B', Interaction = 'isInteraction'
Dataset: 21333 valid pairs out of 21333 total pairs
Using columns: Protein A = 'uniprotID_A', Protein B = 'uniprotID_B', Interaction = 'isInteraction'
Dataset: 24898 valid pairs out of 24898 total pairs
Using columns: Protein A = 'uniprotID_A', Protein B = 'uniprotID_B', Interaction = 'isInteraction'
Dataset: 136939 valid pairs out of 136939 total pairs
Train samples: 85329
Validation samples: 21333
Test1 samples: 24898
Test2 samples: 136939
Creating data loaders with batch_size=8

ðŸ”§ Creating model...
Total parameters: 101,587,201
Trainable parameters: 14,638,849
Frozen parameters: 86,948,352

ðŸš€ Starting training for 50 epochs...

Epoch 1/50
------------------------------
Train - Loss: 0.7010, Acc: 0.5127, AUC: 0.5165
Val   - Loss: 0.6870, Acc: 0.5305, AUC: 0.5965, F1: 0.1816
ðŸŽ‰ New best validation AUC: 0.5965
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_1_best.pth

Epoch 2/50
------------------------------
Train - Loss: 0.6775, Acc: 0.5623, AUC: 0.5957
Val   - Loss: 0.6795, Acc: 0.5612, AUC: 0.6230, F1: 0.6812
ðŸŽ‰ New best validation AUC: 0.6230
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_2_best.pth

Epoch 3/50
------------------------------
Train - Loss: 0.6717, Acc: 0.5723, AUC: 0.6082
Val   - Loss: 0.6649, Acc: 0.5783, AUC: 0.6219, F1: 0.6781

Epoch 4/50
------------------------------
Train - Loss: 0.6689, Acc: 0.5767, AUC: 0.6141
Val   - Loss: 0.6764, Acc: 0.5693, AUC: 0.6196, F1: 0.6770

Epoch 5/50
------------------------------
Train - Loss: 0.6676, Acc: 0.5754, AUC: 0.6143
Val   - Loss: 0.6621, Acc: 0.5804, AUC: 0.6349, F1: 0.6694
ðŸŽ‰ New best validation AUC: 0.6349
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_5_best.pth

Epoch 6/50
------------------------------
Train - Loss: 0.6629, Acc: 0.5819, AUC: 0.6206
Val   - Loss: 0.6668, Acc: 0.5689, AUC: 0.6139, F1: 0.6837

Epoch 7/50
------------------------------
Train - Loss: 0.6602, Acc: 0.5881, AUC: 0.6291
Val   - Loss: 0.6542, Acc: 0.5909, AUC: 0.6471, F1: 0.6796
ðŸŽ‰ New best validation AUC: 0.6471
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_7_best.pth

Epoch 8/50
------------------------------
Train - Loss: 0.6576, Acc: 0.5908, AUC: 0.6316
Val   - Loss: 0.6517, Acc: 0.5910, AUC: 0.6490, F1: 0.6880
ðŸŽ‰ New best validation AUC: 0.6490
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_8_best.pth

Epoch 9/50
------------------------------
Train - Loss: 0.6534, Acc: 0.5949, AUC: 0.6395
Val   - Loss: 0.6553, Acc: 0.5884, AUC: 0.6543, F1: 0.6831
ðŸŽ‰ New best validation AUC: 0.6543
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_9_best.pth

Epoch 10/50
------------------------------
Train - Loss: 0.6511, Acc: 0.5981, AUC: 0.6434
Val   - Loss: 0.6482, Acc: 0.6019, AUC: 0.6518, F1: 0.6690

Epoch 11/50
------------------------------
Train - Loss: 0.6496, Acc: 0.6009, AUC: 0.6470
Val   - Loss: 0.6436, Acc: 0.6053, AUC: 0.6564, F1: 0.6764
ðŸŽ‰ New best validation AUC: 0.6564
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_11_best.pth

Epoch 12/50
------------------------------
Train - Loss: 0.6467, Acc: 0.6044, AUC: 0.6510
Val   - Loss: 0.6418, Acc: 0.6066, AUC: 0.6649, F1: 0.6836
ðŸŽ‰ New best validation AUC: 0.6649
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_12_best.pth

Epoch 13/50
------------------------------
Train - Loss: 0.6451, Acc: 0.6069, AUC: 0.6540
Val   - Loss: 0.6402, Acc: 0.6077, AUC: 0.6654, F1: 0.6730
ðŸŽ‰ New best validation AUC: 0.6654
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_13_best.pth

Epoch 14/50
------------------------------
Train - Loss: 0.6429, Acc: 0.6094, AUC: 0.6587
Val   - Loss: 0.6433, Acc: 0.6123, AUC: 0.6688, F1: 0.6894
ðŸŽ‰ New best validation AUC: 0.6688
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_14_best.pth

Epoch 15/50
------------------------------
Train - Loss: 0.6403, Acc: 0.6111, AUC: 0.6621
Val   - Loss: 0.6386, Acc: 0.6128, AUC: 0.6648, F1: 0.6698

Epoch 16/50
------------------------------
Train - Loss: 0.6385, Acc: 0.6142, AUC: 0.6639
Val   - Loss: 0.6330, Acc: 0.6134, AUC: 0.6756, F1: 0.6955
ðŸŽ‰ New best validation AUC: 0.6756
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_16_best.pth

Epoch 17/50
------------------------------
Train - Loss: 0.6371, Acc: 0.6158, AUC: 0.6675
Val   - Loss: 0.6295, Acc: 0.6178, AUC: 0.6740, F1: 0.6880

Epoch 18/50
------------------------------
Train - Loss: 0.6360, Acc: 0.6174, AUC: 0.6699
Val   - Loss: 0.6325, Acc: 0.6174, AUC: 0.6768, F1: 0.6927
ðŸŽ‰ New best validation AUC: 0.6768
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_18_best.pth

Epoch 19/50
------------------------------
Train - Loss: 0.6331, Acc: 0.6196, AUC: 0.6725
Val   - Loss: 0.6343, Acc: 0.6210, AUC: 0.6757, F1: 0.6881

Epoch 20/50
------------------------------
Train - Loss: 0.6322, Acc: 0.6231, AUC: 0.6754
Val   - Loss: 0.6483, Acc: 0.6120, AUC: 0.6577, F1: 0.6753

Epoch 21/50
------------------------------
Train - Loss: 0.6317, Acc: 0.6224, AUC: 0.6749
Val   - Loss: 0.6267, Acc: 0.6206, AUC: 0.6807, F1: 0.6872
ðŸŽ‰ New best validation AUC: 0.6807
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_21_best.pth

Epoch 22/50
------------------------------
Train - Loss: 0.6288, Acc: 0.6253, AUC: 0.6805
Val   - Loss: 0.6387, Acc: 0.6158, AUC: 0.6672, F1: 0.6814

Epoch 23/50
------------------------------
Train - Loss: 0.6286, Acc: 0.6272, AUC: 0.6809
Val   - Loss: 0.6239, Acc: 0.6289, AUC: 0.6891, F1: 0.6824
ðŸŽ‰ New best validation AUC: 0.6891
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_23_best.pth

Epoch 24/50
------------------------------
Train - Loss: 0.6269, Acc: 0.6302, AUC: 0.6833
Val   - Loss: 0.6335, Acc: 0.6174, AUC: 0.6773, F1: 0.6948

Epoch 25/50
------------------------------
Train - Loss: 0.6242, Acc: 0.6304, AUC: 0.6869
Val   - Loss: 0.6503, Acc: 0.6121, AUC: 0.6693, F1: 0.6971

Epoch 26/50
------------------------------
Train - Loss: 0.6231, Acc: 0.6332, AUC: 0.6892
Val   - Loss: 0.6230, Acc: 0.6251, AUC: 0.6902, F1: 0.7011
ðŸŽ‰ New best validation AUC: 0.6902
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_26_best.pth

Epoch 27/50
------------------------------
Train - Loss: 0.6214, Acc: 0.6353, AUC: 0.6918
Val   - Loss: 0.6363, Acc: 0.6254, AUC: 0.6819, F1: 0.6786

Epoch 28/50
------------------------------
Train - Loss: 0.6202, Acc: 0.6356, AUC: 0.6931
Val   - Loss: 0.6239, Acc: 0.6228, AUC: 0.6920, F1: 0.7056
ðŸŽ‰ New best validation AUC: 0.6920
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_28_best.pth

Epoch 29/50
------------------------------
Train - Loss: 0.6175, Acc: 0.6382, AUC: 0.6979
Val   - Loss: 0.6268, Acc: 0.6251, AUC: 0.6868, F1: 0.6913

Epoch 30/50
------------------------------
Train - Loss: 0.6160, Acc: 0.6403, AUC: 0.7000
Val   - Loss: 0.6195, Acc: 0.6256, AUC: 0.6984, F1: 0.7045
ðŸŽ‰ New best validation AUC: 0.6984
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_30_best.pth

Epoch 31/50
------------------------------
Train - Loss: 0.6152, Acc: 0.6411, AUC: 0.7018
Val   - Loss: 0.6233, Acc: 0.6279, AUC: 0.6897, F1: 0.6978

Epoch 32/50
------------------------------
Train - Loss: 0.6128, Acc: 0.6444, AUC: 0.7050
Val   - Loss: 0.6188, Acc: 0.6320, AUC: 0.6951, F1: 0.6983

Epoch 33/50
------------------------------
Train - Loss: 0.6126, Acc: 0.6453, AUC: 0.7064
Val   - Loss: 0.6181, Acc: 0.6289, AUC: 0.6944, F1: 0.7016

Epoch 34/50
------------------------------
Train - Loss: 0.6108, Acc: 0.6469, AUC: 0.7079
Val   - Loss: 0.6194, Acc: 0.6300, AUC: 0.6962, F1: 0.6992

Epoch 35/50
------------------------------
Train - Loss: 0.6092, Acc: 0.6476, AUC: 0.7097
Val   - Loss: 0.6184, Acc: 0.6309, AUC: 0.6953, F1: 0.6972

Epoch 36/50
------------------------------
Train - Loss: 0.6073, Acc: 0.6504, AUC: 0.7130
Val   - Loss: 0.6192, Acc: 0.6296, AUC: 0.6958, F1: 0.7021

Epoch 37/50
------------------------------
Train - Loss: 0.6050, Acc: 0.6524, AUC: 0.7162
Val   - Loss: 0.6204, Acc: 0.6314, AUC: 0.6925, F1: 0.7012

Epoch 38/50
------------------------------
Train - Loss: 0.6044, Acc: 0.6521, AUC: 0.7169
Val   - Loss: 0.6165, Acc: 0.6357, AUC: 0.7015, F1: 0.7019
ðŸŽ‰ New best validation AUC: 0.7015
ðŸ’¾ Saved best model: models/v5_training_20250606_014243/checkpoint_epoch_38_best.pth

Epoch 39/50
------------------------------
Train - Loss: 0.6030, Acc: 0.6545, AUC: 0.7192
Val   - Loss: 0.6197, Acc: 0.6321, AUC: 0.6952, F1: 0.7017

Epoch 40/50
------------------------------
Train - Loss: 0.6023, Acc: 0.6558, AUC: 0.7211
Val   - Loss: 0.6207, Acc: 0.6355, AUC: 0.6958, F1: 0.6989

Epoch 41/50
------------------------------
Train - Loss: 0.6006, Acc: 0.6593, AUC: 0.7229
Val   - Loss: 0.6181, Acc: 0.6357, AUC: 0.6981, F1: 0.7055

Epoch 42/50
------------------------------
Train - Loss: 0.5994, Acc: 0.6583, AUC: 0.7241
Val   - Loss: 0.6181, Acc: 0.6347, AUC: 0.6990, F1: 0.7013

Epoch 43/50
------------------------------
Train - Loss: 0.5992, Acc: 0.6588, AUC: 0.7239
Val   - Loss: 0.6170, Acc: 0.6360, AUC: 0.6996, F1: 0.7015

Epoch 44/50
------------------------------
Train - Loss: 0.5977, Acc: 0.6609, AUC: 0.7257
Val   - Loss: 0.6180, Acc: 0.6369, AUC: 0.6992, F1: 0.7012

Epoch 45/50
------------------------------
Train - Loss: 0.5967, Acc: 0.6626, AUC: 0.7273
Val   - Loss: 0.6182, Acc: 0.6361, AUC: 0.6992, F1: 0.7015

Epoch 46/50
------------------------------
Train - Loss: 0.5969, Acc: 0.6604, AUC: 0.7269
Val   - Loss: 0.6189, Acc: 0.6366, AUC: 0.6991, F1: 0.7007

Epoch 47/50
------------------------------
Train - Loss: 0.5956, Acc: 0.6623, AUC: 0.7282
Val   - Loss: 0.6173, Acc: 0.6377, AUC: 0.7008, F1: 0.7021

Epoch 48/50
------------------------------
Train - Loss: 0.5964, Acc: 0.6635, AUC: 0.7277
Val   - Loss: 0.6178, Acc: 0.6372, AUC: 0.7005, F1: 0.7010
Early stopping at epoch 48

ðŸ“¥ Loading best model from epoch 38
