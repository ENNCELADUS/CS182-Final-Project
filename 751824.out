ğŸš€ STARTING PPI TRAINING JOB - Mon 02 Jun 2025 10:10:13 PM CST
Job ID: 751824
Node: sist_gpu58
==========================
âœ… Project directory: /public/home/CS182/wangar2023-cs182/CS182-Final-Project

ğŸ” SYSTEM DIAGNOSTICS
======================
ğŸ“Š Memory Info:
              total        used        free      shared  buff/cache   available
Mem:           251G         38G         92G        762M        120G        210G
Swap:           31G        2.2G         29G

ğŸ’¾ CPU Info:
CPU(s):                56
Thread(s) per core:    2
Model name:            Intel(R) Xeon(R) CPU E5-2690 v4 @ 2.60GHz
NUMA node0 CPU(s):     0-13,28-41
NUMA node1 CPU(s):     14-27,42-55

ğŸ® GPU Diagnostics:
NVIDIA GeForce RTX 2080 Ti, 11264, 11003, 0
NVIDIA GeForce RTX 2080 Ti, 11264, 11003, 0

ğŸ”§ CUDA Environment:
CUDA_VISIBLE_DEVICES: 0,1
SLURM GPU IDs: 

ğŸ Python Environment Check:
Python version: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
PyTorch version: 2.6.0+cu124
CUDA available: True
CUDA version: 12.4
GPU count: 2
  GPU 0: NVIDIA GeForce RTX 2080 Ti (10.7 GB)
    Memory test: âœ… PASSED
  GPU 1: NVIDIA GeForce RTX 2080 Ti (10.7 GB)
    Memory test: âœ… PASSED
NumPy version: 2.2.6
Pandas version: 2.2.3

ğŸ› ï¸ APPLYING MEMORY OPTIMIZATIONS
================================
âœ… Memory optimization settings applied
   - PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
   - OMP_NUM_THREADS=8
   - MKL_NUM_THREADS=8

ğŸ” PRE-TRAINING VALIDATION
==========================
ğŸ“ Checking data files...
âœ… Data directory exists
  âœ… train_data.pkl (8.5M)
  âœ… validation_data.pkl (4.6M)
  âœ… test1_data.pkl (6.6M)
  âœ… test2_data.pkl (12M)
  âœ… embeddings_standardized.pkl (23G)

ğŸ“ Preparing output directories...
âœ… Output directories ready

ğŸ¯ STARTING TRAINING
===================
Start time: Mon 02 Jun 2025 10:10:22 PM CST
Training command: python src/mask_autoencoder/v4.py

ğŸ”¥ SCRIPT STARTED - Python v4.py is running!
Enhanced Protein-Protein Interaction Prediction v4
============================================================
Features: RoPE encoding, 16-layer transformers, cross-attention, enhanced MLP
============================================================
ğŸ”¥ ABOUT TO LOAD DATA...
ğŸ”¥ Inside load_data function
ğŸ”¥ Current directory: /public/home/CS182/wangar2023-cs182/CS182-Final-Project/src/mask_autoencoder
Script directory: /public/home/CS182/wangar2023-cs182/CS182-Final-Project/src/mask_autoencoder
Project root: /public/home/CS182/wangar2023-cs182/CS182-Final-Project
Loading data...
Looking for data in: /public/home/CS182/wangar2023-cs182/CS182-Final-Project/data/full_dataset
ğŸ”¥ Checking file existence...
âœ… Found: train_data.pkl
âœ… Found: validation_data.pkl
âœ… Found: test1_data.pkl
âœ… Found: test2_data.pkl
âœ… Found: embeddings_standardized.pkl
ğŸ”¥ Loading pickle files...
ğŸ”¥ Loading train_data.pkl...
ğŸ”¥ Loading validation_data.pkl...
ğŸ”¥ Loading test1_data.pkl...
ğŸ”¥ Loading test2_data.pkl...

Examining training data structure:
DataFrame columns: ['uniprotID_A', 'uniprotID_B', 'isInteraction', 'trainTest', 'sequence_A', 'sequence_B']
First row sample: {'uniprotID_A': 'O43759', 'uniprotID_B': 'P59991', 'isInteraction': 0, 'trainTest': 'train', 'sequence_A': 'MEGGAYGAGKAGGAFDPYTLVRQPHTILRVVSWLFSIVVFGSIVNEGYLNSASEGEEFCIYNRNPNACSYGVAVGVLAFLTCLLYLALDVYFPQISSVKDRKKAVLSDIGVSAFWAFLWFVGFCYLANQWQVSKPKDNPLNEGTDAARAAIAFSFFSIFTWAGQAVLAFQRYQIGADSALFSQDYMDPSQDSSMPYAPYVEPTGPDPAGMGGTYQQPANTFDTEPQGYQSQGY', 'sequence_B': 'MCHTSCSSGCQPACCAPSPCQPACCVPSSCQASCCVPVGCQSSVCVPVSFKPAVCLPVSCQSSVCVPMSFKSAVCVPVSCQSSVCVPVSCRPIVCAAPSCQSSLCVPVSCRPVVYAAPSCQSSGCCQPSCTSVLCRPISYSISSCC'}

Loading protein embeddings...
ğŸ”¥ Loading embeddings_standardized.pkl (this might take a while)...
ğŸ”¥ Embeddings loaded! Count: 12026
ğŸ”¥ ABOUT TO PRINT TRAIN_DATA.HEAD()...
Training data shape: (85329, 6)
Sample row keys: ['uniprotID_A', 'uniprotID_B', 'isInteraction', 'trainTest', 'sequence_A', 'sequence_B']
First protein A: O43759
First protein B: P59991
First interaction: 0
ğŸ”¥ ABOUT TO LOOP THROUGH PROTEIN EMBEDDINGS...
Protein ID: Q00994, Embedding shape: (113, 960)
Protein ID: Q8TC90, Embedding shape: (408, 960)
Protein ID: Q9UJY1, Embedding shape: (198, 960)
Protein ID: Q9Y6Q6, Embedding shape: (618, 960)
Protein ID: A4QMS7, Embedding shape: (149, 960)
ğŸ”¥ RETURNING FROM LOAD_DATA FUNCTION...
ğŸ”¥ DATA LOADING COMPLETED SUCCESSFULLY!

Data loaded successfully:
Training data: 85329 pairs
Validation data: 21333 pairs
Test1 data: 24898 pairs
Test2 data: 136939 pairs
Protein embeddings: 12026 proteins
ğŸ”¥ ABOUT TO CHECK FOR CHECKPOINTS...
ğŸ” Checkpoint detection disabled - starting fresh training...
ğŸ”¥ STARTING TRAINING CONFIGURATIONS...
ğŸ”¥ CONFIGURATIONS DEFINED: 2 configs
ğŸ”¥ ENTERING TRAINING LOOP...
ğŸ”¥ STARTING CONFIG: variable_length

============================================================
Training enhanced model with variable_length embeddings...
============================================================
ğŸ”¥ CALLING train_model() for variable_length...
ğŸ”¥ INSIDE train_model() - START
ğŸ”¥ Parameters: epochs=3, batch_size=16, variable_length=True
ğŸ”¥ Creating ProteinPairDataset for training...
Using columns: Protein A = 'uniprotID_A', Protein B = 'uniprotID_B', Interaction = 'isInteraction'
ğŸ”¥ Dataset filtering: Processing 85329 pairs...
Dataset: 85329 valid pairs out of 85329 total pairs
ğŸ”¥ Creating ProteinPairDataset for validation...
Using columns: Protein A = 'uniprotID_A', Protein B = 'uniprotID_B', Interaction = 'isInteraction'
ğŸ”¥ Dataset filtering: Processing 21333 pairs...
Dataset: 21333 valid pairs out of 21333 total pairs
ğŸ”¥ Creating DataLoader for training dataset (85329 samples)...
ğŸ”¥ Creating DataLoader for validation dataset (21333 samples)...
ğŸ”¥ DataLoaders created successfully!
ğŸ”¥ Calculating training statistics...
ğŸ“Š TRAINING STATISTICS:
Training samples: 85,329
Validation samples: 21,333
Batch size: 16
Training batches per epoch: 5334
Validation batches per epoch: 1334
Total epochs: 3
Total training steps: 16,002
Progress reports every 10 batches
Checkpoints saved every 1 epochs
ğŸ”¥ Starting GPU detection...
ğŸ”¥ CUDA available, clearing cache...

ğŸ” GPU HEALTH CHECK:
Available GPUs: 2
ğŸ”¥ Testing GPU 0...
  GPU 0: NVIDIA GeForce RTX 2080 Ti (10.7GB) - âœ… Working
ğŸ”¥ Testing GPU 1...
  GPU 1: NVIDIA GeForce RTX 2080 Ti (10.7GB) - âœ… Working
Working GPUs: [0, 1]
Will use DataParallel with 2 GPUs
GPU Memory before training: 0.00 GB
ğŸ”¥ Creating enhanced model...
ğŸ”¥ Model created and moved to cuda!
ğŸ”¥ Setting up DataParallel with GPUs: [0, 1]
ğŸ”¥ DataParallel setup successful!
Batch size per GPU: 8
Effective total batch size: 16
ğŸ”¥ Creating optimizer and scheduler...
